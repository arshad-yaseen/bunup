{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Bunup Configuration",
    "description": "Configuration for the bunup bundler",
    "oneOf": [
        {
            "$ref": "#/definitions/BunupOptions"
        },
        {
            "type": "array",
            "items": {
                "$ref": "#/definitions/BunupOptions"
            },
            "description": "Array of build configurations to run"
        }
    ],
    "definitions": {
        "Format": {
            "type": "string",
            "enum": ["esm", "cjs", "iife"],
            "description": "Output format for the bundle"
        },
        "Target": {
            "type": "string",
            "enum": ["bun", "node", "browser"],
            "description": "Target environment for the bundle"
        },
        "External": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "description": "Array of package names to exclude from bundling"
        },
        "Sourcemap": {
            "type": "string",
            "enum": ["none", "linked", "external", "inline"],
            "description": "Type of sourcemap to generate"
        },
        "Entry": {
            "oneOf": [
                {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "Array of entry point file paths"
                },
                {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    },
                    "description": "Object mapping output names to entry point file paths"
                }
            ]
        },
        "DtsOptions": {
            "type": "object",
            "properties": {
                "entry": {
                    "$ref": "#/definitions/Entry",
                    "description": "Entry point files for TypeScript declaration file generation"
                }
            },
            "required": ["entry"],
            "additionalProperties": false
        },
        "BunupOptions": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the build configuration. Used for logging and identification purposes"
                },
                "entry": {
                    "$ref": "#/definitions/Entry",
                    "description": "Entry point files for the build"
                },
                "outDir": {
                    "type": "string",
                    "description": "Output directory for the bundled files",
                    "default": "dist"
                },
                "format": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Format"
                    },
                    "description": "Output formats for the bundle",
                    "default": ["cjs"]
                },
                "minify": {
                    "type": "boolean",
                    "description": "Whether to enable all minification options (whitespace, identifiers, syntax)",
                    "default": false
                },
                "splitting": {
                    "type": "boolean",
                    "description": "Whether to enable code splitting. Defaults to true for ESM format, false for CJS format"
                },
                "minifyWhitespace": {
                    "type": "boolean",
                    "description": "Whether to minify whitespace in the output"
                },
                "minifyIdentifiers": {
                    "type": "boolean",
                    "description": "Whether to minify identifiers in the output (renames variables/functions)"
                },
                "minifySyntax": {
                    "type": "boolean",
                    "description": "Whether to minify syntax in the output (optimizes code structure)"
                },
                "watch": {
                    "type": "boolean",
                    "description": "Whether to watch for file changes and rebuild automatically",
                    "default": false
                },
                "dts": {
                    "oneOf": [
                        {
                            "type": "boolean"
                        },
                        {
                            "$ref": "#/definitions/DtsOptions"
                        }
                    ],
                    "description": "Whether to generate TypeScript declaration files (.d.ts)",
                    "default": false
                },
                "preferredTsconfigPath": {
                    "type": "string",
                    "description": "Path to a preferred tsconfig.json file to use for declaration generation"
                },
                "external": {
                    "$ref": "#/definitions/External",
                    "description": "External packages that should not be bundled",
                    "default": []
                },
                "noExternal": {
                    "$ref": "#/definitions/External",
                    "description": "Packages that should be bundled even if they are in external"
                },
                "target": {
                    "$ref": "#/definitions/Target",
                    "description": "The target environment for the bundle",
                    "default": "node"
                },
                "clean": {
                    "type": "boolean",
                    "description": "Whether to clean the output directory before building",
                    "default": true
                },
                "sourcemap": {
                    "$ref": "#/definitions/Sourcemap",
                    "description": "Specifies the type of sourcemap to generate",
                    "default": "none"
                }
            },
            "required": ["entry"],
            "additionalProperties": false
        }
    }
}
